<!--
=========================================================
* Material Dashboard 3 - v3.2.0
=========================================================

* Product Page: https://www.creative-tim.com/product/material-dashboard
* Copyright 2024 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/png" th:href="@{/assets/img/favicon.ico}"/>
  <title>
    ERPNext - Salary Slips Dashboard
  </title>
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700,900" />
  <!-- Nucleo Icons -->
  <link th:href="@{/assets/css/nucleo-icons.css}" rel="stylesheet" />
  <link th:href="@{/assets/css/nucleo-svg.css}" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <!-- Material Icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
  <!-- CSS Files -->
  <link id="pagestyle" th:href="@{/assets/css/material-dashboard.css?v=3.2.0}" rel="stylesheet" />
  <!-- animations -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
</head>

<body class="g-sidenav-show  bg-gray-100">
  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-radius-lg fixed-start ms-2  bg-white my-2" id="sidenav-main">
    <div class="sidenav-header">
      <i class="fas fa-times p-3 cursor-pointer text-dark opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
    <a class="navbar-brand px-4 py-3 m-0 d-flex align-items-center flex-row flex-nowrap mb-2 mb-lg-0 mx-0 gap-2" th:href="@{/}" style="gap:8px;">
      <div class="fb-69e70d9e"><svg fill="none" height="30" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg">
        <path d="M0 4.8C0 2.14903 2.14903 0 4.8 0H19.2C21.851 0 24 2.14903 24 4.8V19.2C24 21.851 21.851 24 19.2 24H4.8C2.14903 24 0 21.851 0 19.2V4.8Z" fill="#0089FF"></path>
        <path clip-rule="evenodd" d="M16.1729 7.90735H15.7703H10.5368H7.91999V5.76025H16.1729V7.90735ZM10.5367 12.9394V15.8916H16.2399V18.0387H7.91992V10.7923H10.5367H15.7702V12.9394H10.5367Z" fill="white" fill-rule="evenodd"></path>
        </svg>
      </div>
      <div class="fb-d4fba862 "><svg fill="none" height="20" viewBox="0 0 72 14" width="77" xmlns="http://www.w3.org/2000/svg">
        <path d="M2.71078 10.9236V7.92056H8.13235V5.73655H0V13.1076H8.6189V10.9236H2.71078Z" fill="#1F272E"></path>
        <path d="M10.7042 0.617788H15.7087C18.628 0.617788 20.2962 2.18755 20.2962 4.71281C20.2962 6.41907 19.4621 7.64757 18.0719 8.26182L20.7827 13.1076H17.7939L15.3612 8.67133H13.415V13.1076H10.7042V0.617788ZM15.2221 6.55557C16.7513 6.55557 17.5159 5.94131 17.5159 4.71281C17.5159 3.4843 16.7513 2.8018 15.2221 2.8018H13.415V6.55557H15.2221Z" fill="#1F272E"></path>
        <path d="M27.1774 0.617788C30.0967 0.617788 31.7649 2.3923 31.7649 4.84931C31.7649 7.37457 30.0967 9.08083 27.1079 9.08083H24.8142V13.1076H22.1034V0.617788H27.1774ZM26.6909 6.96507C28.22 6.96507 28.9846 6.14606 28.9846 4.84931C28.9846 3.6208 28.22 2.8018 26.6909 2.8018H24.8837V6.96507H26.6909Z" fill="#1F272E"></path>
        <path d="M8.5494 2.8018V0.617788H0V2.8018H8.5494Z" fill="#1F272E"></path>
        <path d="M44.4733 0.5V13.3123H42.1335L36.5594 5.24832H36.4656V13.3123H33.7567V0.5H36.134L41.6643 8.55775H41.7769V0.5H44.4733Z" fill="#1F272E"></path>
        <path d="M50.653 13.5C49.6645 13.5 48.8137 13.2998 48.1005 12.8994C47.3915 12.4949 46.8451 11.9235 46.4614 11.1853C46.0777 10.4429 45.8859 9.56497 45.8859 8.55149C45.8859 7.56304 46.0777 6.69554 46.4614 5.94899C46.8451 5.20244 47.3852 4.62063 48.0818 4.20356C48.7824 3.78649 49.604 3.57796 50.5466 3.57796C51.1806 3.57796 51.7707 3.68014 52.3171 3.8845C52.8676 4.0847 53.3472 4.38707 53.756 4.79163C54.1688 5.19618 54.49 5.70501 54.7194 6.31809C54.9488 6.92701 55.0635 7.6402 55.0635 8.45765V9.18961H46.9494V7.53802H52.5548C52.5548 7.15432 52.4714 6.81441 52.3046 6.51829C52.1377 6.22217 51.9063 5.9907 51.6101 5.82387C51.3182 5.65287 50.9783 5.56737 50.5904 5.56737C50.1859 5.56737 49.8272 5.66121 49.5144 5.84889C49.2057 6.0324 48.9638 6.28056 48.7887 6.59336C48.6135 6.90199 48.5238 7.24607 48.5197 7.6256V9.19586C48.5197 9.67132 48.6073 10.0821 48.7824 10.4283C48.9618 10.7745 49.2141 11.0414 49.5394 11.2291C49.8647 11.4167 50.2505 11.5106 50.6968 11.5106C50.9929 11.5106 51.264 11.4689 51.51 11.3855C51.7561 11.3021 51.9667 11.1769 52.1419 11.0101C52.3171 10.8433 52.4505 10.6389 52.5423 10.397L55.0072 10.5597C54.882 11.1519 54.6255 11.6691 54.2377 12.1112C53.854 12.5491 53.3577 12.8911 52.7487 13.1372C52.144 13.3791 51.4454 13.5 50.653 13.5Z" fill="#1F272E"></path>
        <path d="M58.4702 3.70308L60.2344 7.06256L62.0423 3.70308H64.7762L61.9923 8.5077L64.8513 13.3123H62.1299L60.2344 9.99038L58.3701 13.3123H55.6174L58.4702 8.5077L55.7175 3.70308H58.4702Z" fill="#1F272E"></path>
        <path d="M71.0826 3.70308V5.70501H65.2958V3.70308H71.0826ZM66.6095 1.40087H69.2746V10.3595C69.2746 10.6056 69.3121 10.7974 69.3872 10.935C69.4623 11.0685 69.5665 11.1623 69.7 11.2166C69.8376 11.2708 69.9961 11.2979 70.1755 11.2979C70.3006 11.2979 70.4257 11.2875 70.5508 11.2666C70.6759 11.2416 70.7719 11.2228 70.8386 11.2103L71.2578 13.1935C71.1243 13.2352 70.9366 13.2831 70.6947 13.3373C70.4528 13.3957 70.1588 13.4312 69.8126 13.4437C69.1703 13.4687 68.6073 13.3832 68.1235 13.1872C67.6439 12.9912 67.2706 12.6867 67.0037 12.2738C66.7367 11.8609 66.6054 11.3396 66.6095 10.7098V1.40087Z" fill="#1F272E"></path>
        </svg>
      </div>
    </a>
    </div>
    <hr class="horizontal dark mt-0 mb-2">
    <div class="collapse navbar-collapse  w-auto " id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/suppliers}">
          <i class="material-symbols-rounded opacity-5">store</i>
          <span class="nav-link-text ms-1">Suppliers</span>
          </a>
      </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs text-dark font-weight-bolder opacity-5">Accounting</h6>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/accounting/purchase-invoices}">
            <i class="material-symbols-rounded opacity-5">receipt_long</i>
            <span class="nav-link-text ms-1">Purchase Invoices</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/accounting/sales-invoices}">
            <i class="material-symbols-rounded opacity-5">shopping_cart</i>
            <span class="nav-link-text ms-1">Sale Invoices</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs text-dark font-weight-bolder opacity-5">Buying</h6>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/buying/request-for-quotation}">
            <i class="material-symbols-rounded opacity-5">receipt_long</i>
            <span class="nav-link-text ms-1">Request for Quotation</span>
          </a>
        </li>
        <li class="nav-item mt-3">
            <h6 class="ps-4 ms-2 text-uppercase text-xs text-dark font-weight-bolder opacity-5">HR</h6>
        </li>
        <li class="nav-item">
            <a class="nav-link text-dark" th:href="@{/employees}">
              <i class="material-symbols-rounded opacity-5">group</i>
              <span class="nav-link-text ms-1">Employees</span>
            </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/import-csv-hr}">
            <i class="material-symbols-rounded opacity-5">csv</i>
            <span class="nav-link-text ms-1">Import CSV</span>
          </a>
        </li>
        <li class="nav-item mt-3">
            <h6 class="ps-4 ms-2 text-uppercase text-xs text-dark font-weight-bolder opacity-5">Salary</h6>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/salary-slips}">
            <i class="material-symbols-rounded opacity-5">receipt_long</i>
            <span class="nav-link-text ms-1">Salary Slips</span>
          </a>
        </li>
      <li class="nav-item">
        <a class="nav-link text-dark" th:href="@{/salary-slips/new}">
          <i class="material-symbols-rounded opacity-5">add_circle</i>
          <span class="nav-link-text ms-1">New Salary Slips</span>
        </a>
      </li>
        <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/salary-slips/update}">
            <i class="material-symbols-rounded opacity-5">edit</i>
            <span class="nav-link-text ms-1">Update Salary Slips</span>
          </a>
        </li>
                <li class="nav-item">
          <a class="nav-link text-dark" th:href="@{/salary-slips/search}">
            <i class="material-symbols-rounded opacity-5">search</i>
            <span class="nav-link-text ms-1">Search Salary Slips</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active bg-gradient-info text-white animate__animated animate__fadeIn" th:href="@{/salary-slips/dashboard}">
            <i class="material-symbols-rounded opacity-5">dashboard</i>
            <span class="nav-link-text ms-1">Salary Slips Dashboard</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="sidenav-footer position-absolute w-100 bottom-0 ">
      <div class="mx-3">
        <div class="d-flex align-items-center mb-3">
            <i class="material-symbols-rounded me-2">person</i>
            <span id="user-fullname" class="text-xs font-weight-bolder">Utilisateur</span>
        </div>
        <a class="btn bg-gradient-danger w-100" th:href="@{/logout}" type="button"> <i class="material-symbols-rounded me-2">logout</i> logout</a>
      </div>
    </div>
  </aside>
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-3 shadow-none border-radius-xl" id="navbarBlur" data-scroll="true">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
                <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" th:href="@{/salary-slips}">Salary Slips</a></li>
                <li class="breadcrumb-item text-sm text-dark active" aria-current="page"><a th:href="@{/salary-slips/dashboard}">Dashboard</a></li>
            </ol>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <!-- <div class="input-group input-group-outline">
              <label class="form-label">Type here...</label>
              <input type="text" class="form-control">
            </div> -->
          </div>
          <ul class="navbar-nav d-flex align-items-center  justify-content-end">
            <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
                <div class="sidenav-toggler-inner">
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                </div>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->
    <div class="container-fluid py-2 d-flex flex-column justify-content-between" style="min-height: 94vh;">
      <div class="row mb-4">
        <div class="col-12">
          <div class="card my-4">
            <div class="card-body px-0 pb-2">
              <!-- Filter Section as Popup -->
              <div class="filter-area p-3">
                <form id="filter-form" th:action="@{/salary-slips/dashboard}" method="get">
                  <div id="filter-rows">
                    <div class="row g-3 align-items-end filter-row mb-2">
                      <div class="col-md-3">
                        <div class="input-group input-group-static">
                          <label class="mb-1 text-xs text-secondary" for="filter-year">Year</label>
                          <input type="text" placeholder="YYYY" class="form-control" id="filter-year" name="filter-year" required th:value="${filterYear}">
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="d-flex flex-wrap gap-2 justify-content-start mt-3">
                    <button type="submit" class="btn btn-info btn-sm me-2" id="apply-filter-btn">
                      <span class="material-symbols-rounded">search</span> Search
                    </button>
                    <a th:href="@{/salary-slips/dashboard}" class="btn btn-outline-secondary btn-sm">
                      <span class="material-symbols-rounded">restart_alt</span> Reset
                    </a>
                  </div>
                </form>
              </div>
              <!-- End Filter Section -->
              <div class="table-responsive p-0 m-3">
                <table class="table mb-0" id="salary-table">
                  <thead>
                    <tr>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Month</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Earnings</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Deductions</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Net Paies</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:if="${salarySlipsMonths.empty}">
                      <td colspan="4" class="text-center text-muted">Empty</td>
                    </tr>
                    <tr th:each="monthGroup : ${salarySlipsMonths}" class="salary-row">
                        <td class="text-sm font-weight-bold mb-0">
                            <a th:href="@{'/salary-slips?filter-month=' + ${monthGroup.month}}" th:text="${monthGroup.month}"></a>
                        </td>
                        <td class="text-sm font-weight-bold mb-0 text-success" th:text="${#numbers.formatDecimal(monthGroup.totalEarnings, 1, 'COMMA', 2, 'POINT')}"></td>
                        <td class="text-sm font-weight-bold mb-0 text-danger" th:text="${#numbers.formatDecimal(monthGroup.totalDeductions, 1, 'COMMA', 2, 'POINT')}"></td>
                        <td class="text-sm font-weight-bold mb-0" th:text="${#numbers.formatDecimal(monthGroup.totalNetPay, 1, 'COMMA', 2, 'POINT')}"></td>
                      </tr>
                  </tbody>
                </table>
                <div id="not-found-row" class="text-center text-muted py-3" style="display:none;">Not found</div>
              </div>
              
              <div class="card m-3">
                <div class="card-body p-3">
                  <div class="chart">
                    <canvas id="chart-salary-slips-month" class="chart-canvas" height="300px"></canvas>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
      <footer class="footer py-4  ">
        <div class="container-fluid">
          <div class="row align-items-center justify-content-lg-between">
            <div class="col-lg-6 mb-lg-0 mb-4">
              <div class="copyright text-center text-sm text-muted text-lg-start">
                Â© <script>
                  document.write(new Date().getFullYear())
                </script>,
                IT University - 
                <a href="https://github.com/FanouMah" class="font-weight-bold" target="_blank">Fanou_Mah</a> - ETU002439
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </main>
  <!--   Core JS Files   -->
  <script th:src="@{/assets/js/core/popper.min.js}"></script>
  <script th:src="@{/assets/js/core/bootstrap.min.js}"></script>
  <script th:src="@{/assets/js/plugins/perfect-scrollbar.min.js}"></script>
  <script th:src="@{/assets/js/plugins/smooth-scrollbar.min.js}"></script>
  <script th:src="@{/assets/js/plugins/chartjs.min.js}"></script>
  <script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }
    let fullName = getCookie('full_name');
    if (fullName) {
        fullName = fullName.replace(/%20/g, ' ');
        document.getElementById('user-fullname').textContent = fullName;
    }
  </script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script th:src="@{/assets/js/material-dashboard.min.js?v=3.2.0}"></script>

  <script th:inline="javascript">
    /*<![CDATA[*/
    const salarySlipsMonths = /*[[${salarySlipsMonths}]]*/ [];
    
    const months = salarySlipsMonths.map(m => m.month);
    const netPays = salarySlipsMonths.map(m => m.totalNetPay);
    const earnings = salarySlipsMonths.map(m => m.totalEarnings);
    const deductions = salarySlipsMonths.map(m => m.totalDeductions);
    /*]]>*/
    </script>
    
    <script>
    var ctx = document.getElementById("chart-salary-slips-month").getContext("2d");
    
    new Chart(ctx, {
      type: "line",
      data: {
        labels: months,
        datasets: [
          {
            label: "Net Pay",
            tension: 0.4,
            pointRadius: 0,
            borderColor: "blue",
            borderWidth: 3,
            backgroundColor: "transparent",
            fill: true,
            data: netPays,
            maxBarThickness: 6
          },
          {
            label: "Earnings",
            tension: 0.4,
            pointRadius: 0,
            borderColor: "green",
            borderWidth: 3,
            backgroundColor: "transparent",
            fill: true,
            data: earnings,
            maxBarThickness: 6
          },
          {
            label: "Deductions",
            tension: 0.4,
            pointRadius: 0,
            borderColor: "red",
            borderWidth: 3,
            backgroundColor: "transparent",
            fill: true,
            data: deductions,
            maxBarThickness: 6
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: true,
            labels: {
              color: "#b2b9bf"
            }
          }
        },
        interaction: {
          intersect: false,
          mode: "index"
        },
        scales: {
          y: {
            grid: {
              drawBorder: false,
              drawOnChartArea: true,
              drawTicks: false,
              borderDash: [5, 5]
            },
            ticks: {
              display: true,
              padding: 10,
              color: "#b2b9bf",
              font: {
                size: 11,
                family: "Open Sans",
                style: "normal",
                lineHeight: 2
              },
              callback: value => value
            }
          },
          x: {
            grid: {
              drawBorder: false,
              display: false,
              drawOnChartArea: false,
              drawTicks: false,
              borderDash: [5, 5]
            },
            ticks: {
              display: true,
              padding: 10,
              color: "#b2b9bf",
              font: {
                size: 11,
                family: "Open Sans",
                style: "normal",
                lineHeight: 2
              }
            }
          }
        }
      }
    });
    </script>    

</body>

</html>